<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
          integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" rel="stylesheet">
    <link href="/css/navbar.css" rel="stylesheet">
    <link href="/css/comandas.css" rel="stylesheet">
    <script crossorigin='anonymous' src=/fontawesome-free-6.4.0-web/js/all.js></script>

    <title>Pedidos</title>

</head>

<body>


<div th:insert="~{User/navbar}"></div>

<div class="container">

    <div class="row align-items-start text-break" id="comandaContainer">

        <th:block th:each="pedido : ${pedidos}">
            <div class="card dropdown order">
                <div aria-expanded="false" class=" btn-secondary dropdown-toggle" data-bs-toggle="dropdown"
                     type="button">
                    <h2 class="cliente">Cliente: </h2>
                    <p class="name text-wrap text-center" th:text="${pedido.nomeCliente}">Error</p>
                    <h3 class="mesa" th:text="${'Mesa:' + pedido.mesa.getNumMesa() }">Error</h3>
                </div>
                <ul class="dropdown-menu">
                    <div class="card card-dropdown">
                        <div class="card-body  ">
                            <div class="card-header open">
                                <h5 class="card-title" th:text="${'Comanda: ' + pedido.statusPedido()}">error</h5>
                            </div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item" th:text="'Subtotal: R$' + ${pedido.subTotal()}">Error</li>
                            </ul>
                            <div class="btn-group-vertical " role="group">

                                <a class="btn btn-success addProd"
                                   th:href="'/api/user/'+ ${pedido.id()} + '/categorias'">

                                    Adicionar Produtos
                                </a>
                                <a class="btn btn-primary editComan"
                                   th:href="'/api/user/pedido/'+ ${pedido.id()} + '/finalizarPedido'">
                                    Editar
                                </a>
                                <button class="btn btn-secondary" data-bs-toggle="modal"
                                        th:attr="data-bs-target='#ModalClient'+ ${pedido.id()}"
                                        th:id="${'changeMesa' + pedido.id()}" type="button">
                                    Trocar cliente de mesa
                                </button>
                                <button class="btn remove">Remover</button>
                            </div>


                        </div>
                    </div>
                </ul>
            </div>


        </th:block>
    </div>
</div>

<th:block th:each="pedido : ${pedidos}">

    <div aria-labelledby="staticBackdropLabel" class="modal fade"
         th:attr="aria-labelledby='labelMesa' + ${pedido.id()}" th:id="'ModalClient' + ${pedido.id()}">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" th:id="${'labelMesa' + pedido.id()}">Trocar de mesa</h1>
                    <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                </div>
                <form action="/api/user/changeClientMesa" method="post">
                    <div class="modal-body">
                        <p class="col-first me-3">Selecione a mesa que deseja ocupar</p>
                        <select aria-label="Mesa de destino: " name="mesaDestinoId"
                                class="form-select form-select-lg mb-3 col-last"
                                th:id="${'selectMesa' + pedido.id()}">
                            <option th:each="mesa : ${mesas}" th:id="'mesa-id-' + ${mesa.id}"
                                    th:if="${mesa.mStatus().equals('ACTIVE')}"
                                    th:text="${'Mesa ' + mesa.numMesa()}"
                                    th:value="${mesa.id}">error
                            </option>
                        </select>
                    </div>
                    <div class="modal-footer">
                        <input th:value="${pedido.mesa().getId()}" name="mesaAtualId" type="hidden">


                        <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Fechar</button>
                        <button class="btn btn-primary" type="submit">Mudar de mesa</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

</th:block>



</body>
</html>
<script crossorigin="anonymous"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/Comandas.js"></script>
