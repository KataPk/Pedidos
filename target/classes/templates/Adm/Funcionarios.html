<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" />

    <script src="/fontawesome-free-6.4.0-web/js/all.js"> </script>

    <link href="/css/navbar.css" rel="stylesheet">
    <link href="/css/funcionario.css" rel="stylesheet">
    <script src="/js/navbar.js"></script>
    <title>Funcionários</title>
</head>
<body>
<div th:insert="~{User/navbar}"></div>

<div class="container">

    <div class="row align-items-start text-center" id="FuncionarioContainer">
<!-- criar card para criação de usuário-->
        <div class="card text-center">
            <button id="addButton" class="btn imageBtn addMesa" data-bs-target="#criarUsuario" data-bs-toggle="modal"  type="button">
                <img alt="..." class="card-img-top image" id="AddImage" src="/img/PNG/add_button.png">
            </button>
            <div class="card-body">
                <button class="btn btn-primary createMesa" data-bs-target="#criarUsuario" data-bs-toggle="modal"
                        id="createUser" type="button">
                    Cadastrar Funcionário
                </button>
            </div>
        </div>



    <th:block th:each="user : ${users}">

        <div th:if="${user.statusUsuario == 'ATIVO'}" class="card text-center" style="width: 18rem;">
            <div class="card-body">
                <h5 class="card-title" th:text="${user.nome}">Card title</h5>
                <h6 class="card-subtitle mb-2 text-body-secondary" th:if="${user.roles.contains(RoleAdmin)}"  >Nível de acesso: Administrador</h6>
                <h6 class="card-subtitle mb-2 text-body-secondary" th:if="${user.roles.contains(RoleUser)}">Nível de acesso: Usuário</h6>

                <p class="card-text" th:text="'Username: ' + ${user.username}">Username</p>
                <p class="card-text" th:text="'Email de recuperação: ' + ${user.email}">Email</p>

                <div class="align-items-start">

                <button  class="btn btn-primary" th:attr="data-bs-target=${'#editUsuario' + user.id()}" data-bs-toggle="modal">Editar Funcionário</button>
                    <button th:if="${user.username() != currentUser}" class="btn btn-danger">Excluir Funcionário</button>                </div>
            </div>
        </div>
    </th:block>
    </div>

</div>
        <div id="modals">
            <div  class="modal fade" id="criarUsuario" aria-labelledby="staticBackdropLabel">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5">Criar Usuário</h1>
                            <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                        </div>
                        <form id="formCreate" action="/api/admin/funcionarios/createFuncionario" method="POST">
                            <div class="modal-body vstack text-center">
                                <div class="hstack p-1">
                                    <label class="form-label" for="nomeUsuario">Nome:</label>
                                    <input class="form-control nomeUser " id="nomeUsuario" name="nome" required type="text">
                                </div>
                                <p class="text-danger hstack p-1" style="display: none;"></p>

                                <div class="hstack p-1">
                                <div class="vstack p-1">
                                 <div class="hstack p-1">
                                    <label class="form-label" for="rgUsuario">RG:</label>
                                    <input class="form-control rgUser" id="rgUsuario" name="rg" required type="text"
                                           pattern="\d{2}\.\d{3}\.\d{3}-\d{1}" placeholder="00.000.000-0"
                                    >
                                 </div>
                                    <p class="text-danger hstack p-1" style="display: none;"></p>
                                </div>
                                    <div class="vstack p-1">
                                    <div class="hstack p-1">
                                    <label class="form-label" for="cpfUsuario">CPF:</label>
                                    <input class="form-control cpfUser" id="cpfUsuario" name="cpf" required type="text"
                                           pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" placeholder="000.000.000-00"
                                    >
                                    </div>
                                    <p class="text-danger hstack p-1" style="display: none;"></p>
                                    </div>
                                </div>
                                <div class="hstack p-1">
                                   <div class="vstack p-1">
                                       <div class="hstack p-1">
                                    <label class="form-label" for="dataNascUsuario">Nascimento: </label>
                                    <input class="form-control dataNascUser" id="dataNascUsuario" name="dataNasc" required type="date" >
                                   </div>
                                       <p class="text-danger hstack p-1" style="display: none;"></p>

                                   </div>
                                    <p class="text-danger vstack p-1" style="display: none;"></p>
                                    <div class="vstack p-1">
                                        <div class="hstack p-1">
                                    <label class="form-label" for="cep">CEP: </label>
                                    <input class="form-control input-with-loader cepUser" id="cep" name="cep" required type="text"
                                           placeholder="00000-000"

                                    >
                                    </div>
                                        <p class="text-danger vstack p-1" style="display: none;"></p>
                                    </div>
                                </div>

                                <div class="hstack p-1">
                                    <label class="form-label" for="enderecoUsuario">Endereço: </label>
                                    <input class="form-control input-with-loader enderecoUser" id="enderecoUsuario" name="endereco" required type="text">
                                </div>
                                <div class="hstack p-1">
                                    <label class="form-label" for="numResidUsuario">Número: </label>
                                    <input class="form-control numResidUser" id="numResidUsuario" name="numResid" required type="number" min="1" max="999"
                                           placeholder="000">
                                    <label class="form-label" for="complementoUsuario">Complemento: </label>
                                    <input class="form-control complementoUser" id="complementoUsuario" name="complemento"  type="text">
                                </div>

                                <div class="hstack p-1">
                                    <label class="form-label" for="BairroUsuario">Bairro: </label>
                                    <input class="form-control bairroUser input-with-loader" id="BairroUsuario" name="bairro" required type="text">
                                    <label class="form-label" for="cidade">Cidade: </label>
                                    <input class="form-control cidadeUser input-with-loader" id="cidade" name="cidade" required type="text">
                                    <label class="form-label" for="uf">UF: </label>
                                    <input class="form-control ufUser input-with-loader" id="uf" name="uf" required type="text" maxlength="2" minlength="2"
                                           pattern="[A-Z]{2}" onchange="maskUf(this)" >
                                </div>

                                <div class="vstack p-1">
                                    <div class="hstack p-1">
                                    <label class="form-label" for="telefone1">Telefone: </label>
                                    <input class="form-control telUser tel1User" id="telefone1" name="telefone1" required type="tel" placeholder="(00) 00000-0000">
                                    </div>
                                    <p class="text-danger hstack p-1" style="display: none"></p>

                                    <div class="hstack p-1">

                                        <label class="form-label" for="telefone2">Telefone: </label>
                                    <input class="form-control telUser tel2User" id="telefone2" name="telefoneUser2"  type="tel"
                                           placeholder="(00) 00000-0000">
                                    </div>
                                    <p class="text-danger hstack p-1" style="display: none"></p>

                                </div>

                                <div  class="vstack p-1">
                                   <div  class="hstack p-1">
                                    <label class="form-label" for="emaiRecuperacaolUsuario">Email de Recuperação: </label>
                                    <input class="form-control emailUser" id="emaiRecuperacaolUsuario" name="emailRecup" required type="email">
                                    </div>
                                <p class="text-danger hstack p-1" style="display: none"></p>
                                </div>
                                <div  class="hstack p-1">
                                    <label class="form-label" for="emailUsuario">Email: </label>
                                    <input class="form-control emailUser2" id="emailUsuario" name="emailUser" type="email" >
                                </div>
                                <p class="text-danger hstack p-1" style="display: none"></p>

                                <div class="hstack p-1">
                                    <label class="form-label" for="username">Username: </label>
                                    <input class="form-control" id="username" name="username" required type="text">
                                </div>
                                <div class="hstack p-1">
                                    <label class="form-label" for="senhaUsuario">Senha: </label>
                                    <input class="form-control" id="senhaUsuario" name="senha" required type="password" minlength="8" >
                                    <i class="bi bi-eye-slash eye" id="togglePassword"></i>

                                </div>
                                <p class="text-danger hstack p-1" style="display: none"></p>

                                    <div class="hstack p-1">
                                   <label for="acesso" class="text-xxl-center">Acesso:</label>
                                  <div id="acesso">
                                    <input class=""  id="Role1"  name="Role" value="user" checked required type="radio">
                                    <label class="form-label acesso" for="Role1" >Usuário </label>

                                    <input class=""  id="Role2" name="Role" value="admin" required type="radio">
                                    <label class="form-label acesso" for="Role2">Administrador </label>
                                   </div>

                                </div>
                                <p id="backMessage" class="text-danger hstack p-1" style="display: none"></p>
                                </div>
                                <div class="modal-footer">
                                    <button id="criarUser" class="btn btn-secondary btnSubmit" type="submit">Criar</button>
                                </div>


                        </form>
                    </div>
                </div>
            </div>


            <th:block th:each="user : ${users}" >
    <div th:if="${user.statusUsuario() == 'ATIVO'}" class="modal fade" th:id="${'editUsuario' + user.id()}" aria-labelledby="staticBackdropLabel">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5">Editar Usuário</h1>
                    <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                </div>
                <form action="/api/admin/EditUsuario" class="formEdit" method="POST">
                    <input class="form-control" th:value="${user.id()}" th:id="${'Id' + user.id()}" name="id" required type="hidden" >

                    <div class="modal-body vstack text-center">
                        <div class="hstack p-1">
                            <label class="form-label" th:for="${'nomeUsuario' + user.id()}">Nome:</label>
                            <input class="form-control nomeUser" th:value="${user.nome()}" th:id="${'nomeUsuario' + user.id()}" name="nome" required type="text">
                        </div>
                        <p class="text-danger hstack p-1" style="display: none;"></p>

                        <div class="hstack p-1">
                                <div class="hstack p-1">
                                    <label class="form-label" th:for="${'cep' + user.id()}">CEP: </label>
                                    <input class="form-control cepUser" th:value="${user.cep()}" th:id="${'cep' + user.id()}" name="cep" required type="text"
                                           placeholder="00000-000"

                                    >
                                </div>
                                <p class="text-danger vstack p-1" style="display: none;"></p>
                                <div class="hstack p-1">
                                    <label class="form-label" th:for="${'enderecoUsuario' + user.id()}">Endereço: </label>
                                    <input class="form-control enderecoUser" th:value="${user.logradouro()}" th:id="${'enderecoUsuario' + user.id()}" name="endereco" required type="text">
                                </div>
                            </div>


                        <div class="hstack p-1">
                            <label class="form-label" th:for="${'numResidUsuario' + user.id()}">Número: </label>
                            <input class="form-control numResidUser" th:value="${user.numResid()}" th:id="${'numResidUsuario' + user.id()}" name="numResid" required type="number" min="1" max="999"
                                   placeholder="000">
                            <label class="form-label" th:for="${'complementoUsuario' + user.id()}">Complemento: </label>
                            <input class="form-control complementoUser" th:value="${user.complemento()}" th:id="${'complementoUsuario' + user.id()}" name="complemento"  type="text">
                        </div>

                        <div class="hstack p-1">
                            <label class="form-label" th:for="${'BairroUsuario' + user.id()}">Bairro: </label>
                            <input class="form-control bairroUser" th:value="${user.bairro()}" th:id="${'BairroUsuario' + user.id()}" name="bairro" required type="text">

                            <label class="form-label" th:for="${'cidade' + user.id()}">Cidade: </label>
                            <input class="form-control cidadeUser" th:value="${user.cidade()}" th:id="${'cidade' + user.id()}" name="cidade" required type="text">

                            <label class="form-label" th:for="${'uf' + user.id()}">UF: </label>
                            <input class="form-control ufUser" th:value="${user.uf()}" th:id="${'uf' + user.id()}" name="uf" required type="text" maxlength="2" minlength="2"
                                   pattern="[A-Z]{2}" onchange="maskUf(this)">

                        </div>

                        <div class="vstack p-1">
                            <div class="hstack p-1">
                            <label class="form-label" th:for="${'telefone-1-' + user.id() }" >Telefone: </label>
                            <input class="form-control telUser tel1User" th:id="${'telefone-1-' + user.id() }" name="telefone1"  required type="tel" placeholder="(00) 00000-0000">
                            </div>
                            <p class="text-danger hstack p-1" style="display: none;"></p>
                            <div class="hstack p-1">
                            <label class="form-label" th:for="${'telefone-2-' + user.id() }">Telefone: </label>
                            <input class="form-control telUser tel2User" th:id="${'telefone-2-' + user.id() }" name="telefoneUser2"  type="tel"
                                   placeholder="(00) 00000-0000">
                            </div>
                            <p class="text-danger hstack p-1" style="display: none;"></p>

                        </div>

                        <div  class="vstack p-1">
                            <div  class="hstack p-1">
                                <label class="form-label" th:for="${'emailRecuperacaoUsuario' + user.id()}">Email de recuperação: </label>
                                <input class="form-control emailUser" th:id="${'emailRecuperacaoUsuario' + user.id()}" th:value="${user.email()}" name="emailRecup"  type="email" >
                            </div>
                            <p class="text-danger hstack p-1" style="display: none"></p>
                        </div>
                        <div  class="hstack p-1">
                            <label class="form-label" th:for="${'emailUsuario' + user.id()}">Email: </label>
                            <input class="form-control emailUser2" th:id="${'emailUsuario' + user.id()}"  name="emailUser"  type="email">
                        </div>
                        <p class="text-danger hstack p-1" style="display: none"></p>

                        <div class="hstack p-1">
                            <label class="form-label" th:for="${'username' + user.id()}">Username: </label>
                            <input class="form-control" th:value="${user.username()}" th:id="${'username' + user.id()}" name="username" required type="text">
                        </div>
                        <p class="text-danger hstack p-1" style="display: none"></p>
                        <div class="hstack p-1">
                            <label th:for="${'acesso' + user.id}" class="text-xxl-center">Acesso:</label>
                            <div th:id="${'acesso' + user.id}">
                                <input class=""  th:id="${'Role1' + user.id()}"  name="Role" value="user" th:checked="${user.roles().contains(RoleUser)}"  type="radio">
                                <label class="form-label acesso" th:for="${'Role1' + user.id()}"  >Usuário </label>

                                <input class=""  th:id="${'Role2' + user.id()}" name="Role" value="admin" th:checked="${user.roles().contains(RoleAdmin)}" type="radio">
                                <label class="form-label acesso" th:for="${'Role2' + user.id()}" >Administrador </label>
                            </div>
                            <p class="text-danger hstack p-1 backMessage" style="display: none"></p>

                        </div>

                        <div class="modal-footer">
                            <button th:id="${'criarUser' + user.id()}" class="btn btn-secondary btnSubmit" type="submit">Salvar alterações</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

</th:block>
        </div>



</body>

</html>
<script src="/js/funcionario.js"></script>

